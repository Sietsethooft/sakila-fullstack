<section class="client-card">
  <h2 class="h2-head">Rental-management</h2>
  <div class="d-flex mb-3 flex-wrap">
    <button class="btn btn-primary" type="button" id="add-movie-btn" style="margin-right: 10px;">
      <i class="fas fa-film me-2"></i> Create rental
    </button>
  </div>

  <h3>Overdue Rentals</h3>
  <table class="table-800 table table-bordered">
    <colgroup>
      <col style="width: 25%;">
      <col style="width: 30%;">
      <col style="width: 12.5%;">
      <col style="width: 12.5%;">
      <col style="width: 10%;">
      <col style="width: 15%;">
      <col style="width: 5%;">
    <thead>
      <tr>
        <th>Customer</th>
        <th>Film</th>
        <th>Rented on</th>
        <th>Return by</th>
        <th>Price</th>
        <th>Fine</th>
        <th class="text-center">Returned?</th>
      </tr>
    </thead>
    <tbody>
      <% if (overdueRentals && overdueRentals.length > 0) { %>
        <% overdueRentals.forEach(function(rental) { %>
          <tr>
            <td><%= rental.customer_name %></td>
            <td><%= rental.title %></td>
            <td><%= rental.rental_date %></td>
            <td><%= rental.due_date %></td>
            <td>€ <%= rental.expected_amount %></td>
            <td>+ € <%= rental.fine_amount %></td>
            <td class="text-center">
              <button
                  type="button"
                  style="width:80%;"
                  class="btn btn-sm btn-outline-success return-rental"
                  data-id="<%= rental.rental_id %>"
                  title="Mark rental as returned"
                  aria-label="Mark rental as returned"
              >✓</button>
            </td>
          </tr>
        <% }); %>
      <% } else { %>
        <tr>
          <td colspan="7" class="text-center">No overdue rentals found</td>
        </tr>
      <% } %>
    </tbody>
  </table>

  <h3>Open rentals</h3>
  <table class="table-800 table table-bordered open-rentals-table">
    <colgroup>
      <col style="width: 25%;">
      <col style="width: 30%;">
      <col style="width: 15%;">
      <col style="width: 15%;">
      <col style="width: 10%;">
      <col style="width: 5%;">
    <thead>
      <tr>
        <th>Customer</th>
        <th>Film</th>
        <th>Rented on</th>
        <th>Return by</th>
        <th>Price</th>
        <th class="text-center">Returned?</th>
      </tr>
    </thead>
    <tbody>
      <% if (openRentals && openRentals.length > 0) { %>
        <% openRentals.forEach(function(rental) { %>
          <tr>
            <td><%= rental.customer_name %></td>
            <td><%= rental.title %></td>
            <td><%= rental.rental_date %></td>
            <td><%= rental.return_by %></td>
            <td>€ <%= rental.amount %></td>
            <td class="text-center">
              <button
                  type="button"
                  class="btn btn-sm btn-outline-success return-rental"
                  style="width:80%;"
                  data-id="<%= rental.rental_id %>"
                  title="Mark rental as returned"
                  aria-label="Mark rental as returned"
              >✓</button>
            </td>
          </tr>
        <% }); %>
      <% } else { %>
        <tr>
          <td colspan="6" class="text-center">No open rentals found</td>
        </tr>
      <% } %>
    </tbody>
  </table>
</section>

<!-- Hidden form to make a POST request -->
<form id="close-rental-form" method="POST" style="display:none;">
</form>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/javascripts/rentalScripts/rentalIndex.js"></script>
  <script>
    window.rentalSuccess = '<%= success ? success : '' %>';
  </script>
<script src="/javascripts/rentalScripts/rentalAlerts.js"></script>