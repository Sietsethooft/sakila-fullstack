<section class="client-card">

    <h2 class="mb-4">Edit Movie</h2>

    <% if (typeof errors !== 'undefined' && errors.length > 0) { %>
        <div class="alert alert-danger">
            <ul>
                <% errors.forEach(function(error) { %>
                    <li><%= error %></li>
                <% }); %>
            </ul>
        </div>
    <% } %>

    <form id="edit-movie-form" action="/movieManagement/<%= movie.film_id %>/update" method="POST" novalidate>
        <div class="mb-3">
            <label for="title" class="form-label fw-bold">Title *</label>
            <input type="text" class="form-control input-field-focus" id="title" name="title" required value="<%= movie.title %>">
            <div class="invalid-feedback">Title is required.</div>
        </div>
        <div class="mb-3">
            <label for="description" class="form-label fw-bold">Description *</label>
            <textarea class="form-control input-field-focus rounded" id="description" name="description" rows="4" required><%= movie.description %></textarea>
            <div class="invalid-feedback">Description is required.</div>
        </div>
        <div class="row g-3 mb-3">
            <div class="col-md-6">
                <div class="input-card p-3 shadow-sm rounded">
                    <label for="release_year" class="form-label fw-bold">Year</label>
                    <input type="number" class="form-control input-field-focus" id="release_year" name="release_year" min="1900" max="2099" value="<%= movie.release_year %>">
                </div>
            </div>
            <div class="col-md-6">
                <div class="input-card p-3 shadow-sm rounded">
                    <label for="language" class="form-label fw-bold">Language *</label>
                    <input type="text" class="form-control input-field-focus" id="language" name="language_name" required value="<%= movie.language_name %>">
                    <div class="invalid-feedback">Language is required.</div>
                </div>
            </div>
        </div>
        <div class="row g-3 mb-3">
            <div class="col-md-6">
                <div class="input-card p-3 shadow-sm rounded">
                    <label for="category" class="form-label fw-bold">Category *</label>
                    <select class="form-control input-field-focus" id="category" name="category_id" required>
                        <option value="">Select category</option>
                        <% categories.forEach(function(category) { %>
                            <option value="<%= category.category_id %>" <%= movie.category_id == category.category_id ? 'selected' : '' %>><%= category.name %></option>
                        <% }); %>
                    </select>
                    <div class="invalid-feedback">Category is required.</div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="input-card p-3 shadow-sm rounded">
                    <label for="rating" class="form-label fw-bold">Rating *</label>
                    <select class="form-control input-field-focus" id="rating" name="rating" required>
                        <option value="">Select rating</option>
                        <% ratings.forEach(function(rating) { %>
                            <option value="<%= rating %>" <%= movie.rating == rating ? 'selected' : '' %>><%= rating %></option>
                        <% }); %>
                    </select>
                    <div class="invalid-feedback">Rating is required.</div>
                </div>
            </div>
        </div>
        <div class="row g-3 mb-3">
            <div class="col-md-6">
                <div class="input-card p-3 shadow-sm rounded">
                    <label for="rental_duration" class="form-label fw-bold">Rental duration (days) *</label>
                    <input type="number" class="form-control input-field-focus" id="rental_duration" name="rental_duration" required min="1" value="<%= movie.rental_duration %>">
                    <div class="invalid-feedback">Rental duration is required.</div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="input-card p-3 shadow-sm rounded">
                    <label for="rental_rate" class="form-label fw-bold">Rental price (â‚¬) *</label>
                    <input type="number" step="0.01" class="form-control input-field-focus" id="rental_rate" name="rental_rate" required min="0" value="<%= movie.rental_rate %>">
                    <div class="invalid-feedback">Rental price is required.</div>
                </div>
            </div>
        </div>
        <div class="row g-3 mb-3">
            <div class="col-md-6">
                <div class="input-card p-3 shadow-sm rounded">
                    <label for="length" class="form-label fw-bold">Length (minutes)</label>
                    <input type="number" class="form-control input-field-focus" id="length" name="length" min="1" value="<%= movie.length %>">
                </div>
            </div>
            <div class="col-md-6">
                <div class="input-card p-3 shadow-sm rounded">
                    <label for="inventory" class="form-label fw-bold">Number of copies *</label>
                    <input type="number" class="form-control input-field-focus" id="inventory" name="inventory" required min="1" value="<%= movie.total_inventory %>">
                    <div class="invalid-feedback">Number of copies is required.</div>
                </div>
            </div>
        </div>
        <button type="submit" class="btn btn-primary px-4">Save</button>
    </form>
</section>

<script>
    document.getElementById('edit-movie-form').addEventListener('submit', function(event) {
        const form = event.target;
        if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
        }
        form.classList.add('was-validated');
    });
</script>