<section class="client-card">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      window.movieError = '<%= error ? error : '' %>';
      window.movieSuccess = '<%= success ? success : '' %>';
    </script>
    <script src="/javascripts/movieScripts/movieDetail.js"></script>
    <script src="/javascripts/movieScripts/movieAlerts.js"></script>

    <div class="d-flex justify-content-between align-items-center">
        <h2><%= movie.title %></h2>
        <div class="mb-1">
            <a href="/movieManagement/<%= movie.film_id %>/edit" class="btn btn-warning me-2">
                <i class="fas fa-edit"></i> Edit
            </a>
            <form id="delete-movie-form" action="/movieManagement/<%= movie.film_id %>/delete" method="POST" style="display:inline;">
                <button type="button" class="btn btn-danger" id="delete-movie-btn">
                    <i class="fas fa-trash-alt"></i> Delete
                </button>
            </form>           
        </div>
    </div>

<p style="max-width: 80%"><em><%= movie.description %></em></p>

  <div class="row mb-4">
    <div class="col-md-6">
        <table class="table table-bordered">
        <colgroup>
            <col style="width:35%">
            <col style="width:65%">
        </colgroup>
        <tr>
            <th>Category</th>
            <td><%= movie.category_name %></td>
        </tr>
        <tr>
            <th>Language</th>
            <td><%= movie.language_name %></td>
        </tr>
        <% if (movie.release_year) { %>
        <tr>
            <th>Year</th>
            <td><%= movie.release_year %></td>
        </tr>
        <% } %>
        <% if (movie.length) { %>
        <tr>
            <th>Length</th>
            <td><%= movie.length %> minutes</td>
        </tr>
        <% } %>
        <tr>
            <th>Rating</th>
            <td><%= movie.rating %></td>
        </tr>
        <tr>
            <th>Last update</th>
            <td><%= movie.last_update %></td>
        </tr>
        </table>

        <table class="table table-bordered">
        <colgroup>
            <col style="width:35%">
            <col style="width:65%">
        </colgroup>
        <tr>
            <th>Rental price</th>
            <td>€ <%= movie.rental_rate %></td>
        </tr>
        <tr>
            <th>Rental duration</th>
            <td><%= movie.rental_duration %> days</td>
        </tr>
        <tr>
            <th>Available</th>
            <td><%= movie.total_available %> of <%= movie.total_inventory %></td>
        </tr>
        </table>
    </div>
    <div class="col-md-4 <%= (movie.length || movie.release_year) ? 'mt-3' : '' %> align-items-center justify-content-center">
        <img src="https://picsum.photos/480/320?random=1" class="img-fluid rounded shadow movie-img-large" alt="The Matrix">
    </div>
  </div>

<h3>Outstanding Rentals</h3>
<table class="table-800 table table-bordered">
  <thead>
    <tr>
      <th>Customer</th>
      <th>Rented on</th>
      <th>Return by</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <% if (activeRentals && activeRentals.length > 0) { %>
      <% activeRentals.forEach(function(rental) { %>
        <tr>
          <td><%= rental.customer_name %></td>
          <td><%= rental.rental_date %></td>
          <td><%= rental.return_by %></td>
          <td>€ <%= rental.amount %></td>
        </tr>
      <% }); %>
    <% } else { %>
      <tr>
        <td colspan="4" class="text-center">No outstanding rentals found</td>
      </tr>
    <% } %>
  </tbody>
</table>

<h3>Rental History</h3>
<table class="table-800 table table-bordered">
  <thead>
    <tr>
      <th>Customer</th>
      <th>Rented on</th>
      <th>Returned on</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <% if (rentalHistory && rentalHistory.length > 0) { %>
      <% rentalHistory.forEach(function(rental) { %>
        <tr>
          <td><%= rental.customer_name %></td>
          <td><%= rental.rental_date %></td>
          <td><%= rental.return_date %></td>
          <td>€ <%= rental.amount %></td>
        </tr>
      <% }); %>
    <% } else { %>
      <tr>
        <td colspan="4" class="text-center">No rental history found</td>
      </tr>
    <% } %>
  </tbody>
</table>
</section>